{"version":3,"file":"OnboardToken-_4pBZCak.js","sources":["../../src/pages/onboarding/OnboardToken.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useSearchParams, useNavigate } from 'react-router-dom';\r\nimport { apiClient } from '../../lib/api-client';\r\nimport { supabase } from '../../lib/supabase';\r\nimport Button from '../../components/Button';\r\nimport Card from '../../components/Card';\r\nimport { CheckCircle, AlertCircle, Clock, CreditCard, Star, DollarSign, Phone } from 'lucide-react';\r\n\r\ninterface BusinessInviteData {\r\n  is_valid: boolean;\r\n  business_name: string;\r\n  business_email: string;\r\n  pricing_tier: string | null;\r\n  expires_at: string;\r\n}\r\n\r\ninterface PricingTier {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  price_cents: number;\r\n  stripe_price_id: string;\r\n}\r\n\r\ninterface CheckoutResponse {\r\n  success: boolean;\r\n  data: {\r\n    sessionId: string;\r\n    checkoutUrl: string;\r\n  };\r\n}\r\n\r\nconst OnboardToken: React.FC = () => {\r\n  const { token } = useParams<{ token: string }>();\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  \r\n  const [inviteData, setInviteData] = useState<BusinessInviteData | null>(null);\r\n  const [pricingTiers, setPricingTiers] = useState<PricingTier[]>([]);\r\n  const [selectedTierId, setSelectedTierId] = useState<string>('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [processingPayment, setProcessingPayment] = useState(false);\r\n  \r\n  const sessionId = searchParams.get('session_id');\r\n  const success = searchParams.get('success');\r\n  const canceled = searchParams.get('canceled');\r\n\r\n  useEffect(() => {\r\n    if (!token) {\r\n      setError('No invitation token provided');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    validateTokenAndLoadData();\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (sessionId && success) {\r\n      handlePaymentSuccess();\r\n    }\r\n  }, [sessionId, success]);\r\n\r\n  const validateTokenAndLoadData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      // Validate business invitation token\r\n      const tokenResponse = await apiClient.post<{\r\n        success: boolean;\r\n        data: BusinessInviteData;\r\n      }>('/api/validate-business-invitation', {\r\n        token: token\r\n      });\r\n\r\n      if (!tokenResponse.success || !tokenResponse.data.is_valid) {\r\n        setError('Invalid or expired business invitation token');\r\n        return;\r\n      }\r\n\r\n      setInviteData(tokenResponse.data);\r\n\r\n      // Load pricing tiers from business_pricing_tiers table\r\n      const { data: tiersData, error: tiersError } = await supabase\r\n        .from('business_pricing_tiers')\r\n        .select('id, name, description, monthly_price_cents, stripe_price_id')\r\n        .eq('is_active', true)\r\n        .order('monthly_price_cents', { ascending: true });\r\n      \r\n      if (tiersError) {\r\n        console.error('Error loading pricing tiers:', tiersError);\r\n        setError('Failed to load pricing options');\r\n        return;\r\n      }\r\n\r\n      // Transform data to match component interface\r\n      const formattedTiers = tiersData?.map(tier => ({\r\n        id: tier.id,\r\n        name: tier.name,\r\n        description: tier.description || `${tier.name} subscription plan`,\r\n        price_cents: tier.monthly_price_cents,\r\n        stripe_price_id: tier.stripe_price_id\r\n      })) || [];\r\n\r\n      setPricingTiers(formattedTiers);\r\n\r\n      // NO pre-selection - let business choose their own tier\r\n\r\n    } catch (err: any) {\r\n      console.error('Error validating token and loading data:', err);\r\n      setError(err.message || 'Failed to validate invitation');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePaymentSuccess = async () => {\r\n    try {\r\n      setProcessingPayment(true);\r\n      \r\n      // Verify the payment with our business subscription endpoint\r\n      const response = await apiClient.post<{\r\n        success: boolean;\r\n        data: {\r\n          subscription: {\r\n            id: string;\r\n            status: string;\r\n            currentPeriodEnd: number;\r\n          };\r\n          pricing_tier: string;\r\n        };\r\n      }>('/api/verify-business-subscription', { token, sessionId });\r\n      \r\n      const subscription = response.data.subscription;\r\n      \r\n      if (subscription.status === 'active') {\r\n        // Redirect to business setup form\r\n        navigate(`/onboard/${token}/setup?session_id=${sessionId}`);\r\n      } else {\r\n        setError('Payment verification failed. Please contact support.');\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Error verifying payment:', err);\r\n      setError('Payment verification failed. Please contact support.');\r\n    } finally {\r\n      setProcessingPayment(false);\r\n    }\r\n  };\r\n\r\n  const handleTierSelection = async () => {\r\n    if (!selectedTierId) {\r\n      setError('Please select a pricing tier');\r\n      return;\r\n    }\r\n\r\n    const selectedTier = pricingTiers.find(tier => tier.id === selectedTierId);\r\n    if (!selectedTier) {\r\n      setError('Selected tier not found');\r\n      return;\r\n    }\r\n\r\n    if (!selectedTier.stripe_price_id) {\r\n      setError('This tier is not available for online signup');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setProcessingPayment(true);\r\n      setError(null);\r\n\r\n      // DEBUG: Log the data being sent to API\r\n      console.log('üîç DEBUG - Frontend sending checkout data:', {\r\n        token,\r\n        tier_id: selectedTierId,\r\n        selectedTier: selectedTier\r\n      });\r\n\r\n      const response = await apiClient.post<CheckoutResponse>(\r\n        '/api/create-business-checkout',\r\n        { \r\n          token,\r\n          tier_id: selectedTierId\r\n        }\r\n      );\r\n\r\n      if (response.success && response.data.checkoutUrl) {\r\n        // Redirect to Stripe Checkout\r\n        window.location.href = response.data.checkoutUrl;\r\n      } else {\r\n        setError('Failed to create checkout session');\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Error creating checkout session:', err);\r\n      setError(err.message || 'Failed to start checkout process');\r\n      setProcessingPayment(false);\r\n    }\r\n  };\r\n\r\n  const formatPrice = (priceInCents: number) => {\r\n    return `$${(priceInCents / 100).toFixed(0)}`;\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-[#fdfaf7] px-6 py-10\">\r\n        <div className=\"text-center\">\r\n          <div className=\"h-12 w-12 animate-spin border-4 border-[#800020] border-t-transparent rounded-full mx-auto mb-6\"></div>\r\n          <p className=\"text-gray-600 text-lg\">Validating your invitation...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (processingPayment) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-[#fdfaf7] px-6 py-10\">\r\n        <div className=\"text-center\">\r\n          <div className=\"h-12 w-12 animate-spin border-4 border-[#800020] border-t-transparent rounded-full mx-auto mb-6\"></div>\r\n          <p className=\"text-gray-600 text-lg\">Processing your payment...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (canceled) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-[#fdfaf7] px-6 py-10\">\r\n        <Card className=\"max-w-md mx-auto p-8 text-center\">\r\n          <AlertCircle className=\"h-16 w-16 text-yellow-500 mx-auto mb-4\" />\r\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Payment Canceled</h1>\r\n          <p className=\"text-gray-600 mb-6\">\r\n            Your payment was canceled. You can try again when you're ready.\r\n          </p>\r\n          <Button onClick={() => window.location.reload()} className=\"w-full\">\r\n            Try Again\r\n          </Button>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || !inviteData) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-[#fdfaf7] px-6 py-10\">\r\n        <Card className=\"max-w-md mx-auto p-8 text-center\">\r\n          <AlertCircle className=\"h-16 w-16 text-red-500 mx-auto mb-4\" />\r\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Invalid Invitation</h1>\r\n          <p className=\"text-gray-600 mb-6\">\r\n            {error || 'This invitation link is invalid or has expired. Please request a new one.'}\r\n          </p>\r\n          <Button onClick={() => navigate('/landing')} variant=\"secondary\" className=\"w-full\">\r\n            Return Home\r\n          </Button>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const selectedTier = pricingTiers.find(tier => tier.id === selectedTierId);\r\n  const expiresAt = new Date(inviteData.expires_at);\r\n  const timeUntilExpiry = expiresAt.getTime() - Date.now();\r\n  const hoursUntilExpiry = Math.floor(timeUntilExpiry / (1000 * 60 * 60));\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[#fdfaf7] px-6 py-10\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"text-center mb-12\">\r\n          <div className=\"mb-6\">\r\n            <h1 className=\"text-5xl font-bold bg-gradient-to-r from-[#800020] to-[#a00030] bg-clip-text text-transparent mb-4\">\r\n              Welcome to Club Cuv√©e\r\n            </h1>\r\n            <div className=\"w-24 h-1 bg-gradient-to-r from-[#800020] to-[#a00030] mx-auto rounded-full\"></div>\r\n          </div>\r\n          <p className=\"text-2xl text-gray-700 mb-3\">\r\n            Start your luxury wine club journey with <strong className=\"text-[#800020]\">{inviteData.business_name}</strong>\r\n          </p>\r\n          <p className=\"text-gray-600 bg-gray-50 inline-block px-4 py-2 rounded-full\">\r\n            {inviteData.business_email}\r\n          </p>\r\n        </div>\r\n\r\n        {/* Expiry Warning */}\r\n        {hoursUntilExpiry < 24 && hoursUntilExpiry > 0 && (\r\n          <Card className=\"p-4 mb-6 bg-yellow-50 border-yellow-200\">\r\n            <div className=\"flex items-center\">\r\n              <Clock className=\"h-5 w-5 text-yellow-500 mr-2\" />\r\n              <p className=\"text-sm text-yellow-700\">\r\n                This invitation expires in {hoursUntilExpiry} hours. Complete your registration soon!\r\n              </p>\r\n            </div>\r\n          </Card>\r\n        )}\r\n\r\n        {/* Main Content */}\r\n        <Card className=\"p-8 mb-8 bg-gradient-to-br from-white to-gray-50 border-gray-200 shadow-xl\">\r\n          <div className=\"text-center mb-8\">\r\n            <h2 className=\"text-3xl font-bold text-gray-900 mb-3\">\r\n              Select Your Club Cuv√©e Subscription\r\n            </h2>\r\n            <p className=\"text-gray-600 text-lg\">\r\n              Choose the perfect plan to grow your wine business\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-8\">\r\n            {pricingTiers.map((tier, index) => (\r\n              <div\r\n                key={tier.id}\r\n                className={`group relative bg-white border-2 rounded-xl p-8 cursor-pointer transition-all duration-300 hover:scale-105 ${\r\n                  selectedTierId === tier.id\r\n                    ? 'border-[#800020] shadow-2xl shadow-[#800020]/20 bg-gradient-to-br from-[#800020]/5 to-white'\r\n                    : 'border-gray-200 hover:border-[#800020]/30 hover:shadow-xl'\r\n                }`}\r\n                onClick={() => setSelectedTierId(tier.id)}\r\n              >\r\n                <div className=\"text-center\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"tier\"\r\n                    value={tier.id}\r\n                    checked={selectedTierId === tier.id}\r\n                    onChange={() => setSelectedTierId(tier.id)}\r\n                    className=\"sr-only\"\r\n                  />\r\n                  \r\n                  {/* Popular badge for middle tier */}\r\n                  {index === 1 && (\r\n                    <div className=\"absolute -top-4 left-1/2 transform -translate-x-1/2\">\r\n                      <span className=\"bg-gradient-to-r from-[#800020] to-[#a00030] text-white px-4 py-2 rounded-full text-sm font-semibold shadow-lg\">\r\n                        Most Popular\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                  \r\n                  <div className=\"mb-6\">\r\n                    <h3 className=\"text-2xl font-bold text-gray-900 mb-3\">{tier.name}</h3>\r\n                    <p className=\"text-gray-600 text-sm leading-relaxed\">{tier.description}</p>\r\n                  </div>\r\n                  \r\n                  <div className=\"mb-6\">\r\n                    <div className=\"text-4xl font-bold text-[#800020] mb-2\">\r\n                      {formatPrice(tier.price_cents)}\r\n                    </div>\r\n                    <div className=\"text-gray-500 font-medium\">per month</div>\r\n                  </div>\r\n                  \r\n                  {selectedTierId === tier.id ? (\r\n                    <div className=\"flex items-center justify-center space-x-2 text-[#800020]\">\r\n                      <CheckCircle className=\"w-6 h-6\" />\r\n                      <span className=\"font-semibold\">Selected</span>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"flex items-center justify-center space-x-2 text-gray-400 group-hover:text-[#800020] transition-colors\">\r\n                      <div className=\"w-6 h-6 border-2 border-current rounded-full\"></div>\r\n                      <span className=\"font-medium\">Select Plan</span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n\r\n          {error && (\r\n            <div className=\"p-4 bg-red-50 border border-red-200 rounded-lg mb-6\">\r\n              <p className=\"text-sm text-red-600 flex items-center\">\r\n                <AlertCircle className=\"w-5 h-5 mr-3\" />\r\n                {error}\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Action Button */}\r\n          <div className=\"text-center\">\r\n            {selectedTierId ? (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"p-4 bg-[#800020]/5 border border-[#800020]/20 rounded-lg\">\r\n                  <p className=\"text-sm text-gray-700 mb-2\">\r\n                    <strong>Selected Plan:</strong> {pricingTiers.find(t => t.id === selectedTierId)?.name}\r\n                  </p>\r\n                  <p className=\"text-2xl font-bold text-[#800020]\">\r\n                    {formatPrice(pricingTiers.find(t => t.id === selectedTierId)?.price_cents || 0)} / month\r\n                  </p>\r\n                </div>\r\n                \r\n                <button\r\n                  onClick={handleTierSelection}\r\n                  disabled={processingPayment}\r\n                  className=\"w-full bg-gradient-to-r from-[#800020] to-[#a00030] text-white font-semibold py-4 px-8 rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 disabled:opacity-50 disabled:transform-none disabled:hover:shadow-lg\"\r\n                >\r\n                  {processingPayment ? (\r\n                    <div className=\"flex items-center justify-center space-x-3\">\r\n                      <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\"></div>\r\n                      <span>Starting Secure Checkout...</span>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"flex items-center justify-center space-x-3\">\r\n                      <CreditCard className=\"w-5 h-5\" />\r\n                      <span>Proceed to Secure Payment</span>\r\n                    </div>\r\n                  )}\r\n                </button>\r\n                \r\n                <p className=\"text-xs text-gray-500 flex items-center justify-center space-x-2\">\r\n                  <span>üîí Secure payment processing by Stripe</span>\r\n                  <span>‚Ä¢</span>\r\n                  <span>Cancel anytime</span>\r\n                </p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"p-4 bg-gray-50 border border-gray-200 rounded-lg\">\r\n                <p className=\"text-gray-600 text-center\">\r\n                  Please select a subscription plan to continue\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Card>\r\n\r\n        {/* What's Next */}\r\n        <Card className=\"p-8 bg-gradient-to-r from-gray-50 to-gray-100 border-gray-200\">\r\n          <h3 className=\"text-2xl font-bold text-gray-900 mb-6 text-center\">Your Onboarding Journey</h3>\r\n          <div className=\"space-y-6\">\r\n            <div className=\"flex items-start\">\r\n              <div className=\"w-8 h-8 bg-gradient-to-r from-[#800020] to-[#a00030] text-white rounded-full flex items-center justify-center text-sm font-bold mr-4 mt-1\">\r\n                1\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-gray-900 mb-1\">Secure Payment Processing</p>\r\n                <p className=\"text-gray-600\">Complete your subscription payment through our secure Stripe integration</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-start\">\r\n              <div className=\"w-8 h-8 bg-gradient-to-r from-[#800020] to-[#a00030] text-white rounded-full flex items-center justify-center text-sm font-bold mr-4 mt-1\">\r\n                2\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-gray-900 mb-1\">Business Profile Setup</p>\r\n                <p className=\"text-gray-600\">Create your account, set business details, and configure your wine club tiers</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-start\">\r\n              <div className=\"w-8 h-8 bg-gradient-to-r from-[#800020] to-[#a00030] text-white rounded-full flex items-center justify-center text-sm font-bold mr-4 mt-1\">\r\n                3\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-gray-900 mb-1\">Wine Inventory & AI Setup</p>\r\n                <p className=\"text-gray-600\">Upload your wine inventory and let our AI create personalized recommendations</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-start\">\r\n              <div className=\"w-8 h-8 bg-gradient-to-r from-[#800020] to-[#a00030] text-white rounded-full flex items-center justify-center text-sm font-bold mr-4 mt-1\">\r\n                4\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-gray-900 mb-1\">Launch Your Wine Club</p>\r\n                <p className=\"text-gray-600\">Start accepting customer memberships and grow your recurring revenue</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </Card>\r\n\r\n        {/* Support */}\r\n        <div className=\"text-center mt-8 text-sm text-gray-500\">\r\n          <p>\r\n            Need help? Contact our support team at{' '}\r\n            <a href=\"mailto:support@clubcuvee.com\" className=\"text-[#800020] hover:underline\">\r\n              support@clubcuvee.com\r\n            </a>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OnboardToken;"],"names":["OnboardToken","token","useParams","searchParams","useSearchParams","navigate","useNavigate","inviteData","setInviteData","useState","pricingTiers","setPricingTiers","selectedTierId","setSelectedTierId","loading","setLoading","error","setError","processingPayment","setProcessingPayment","sessionId","success","canceled","useEffect","validateTokenAndLoadData","handlePaymentSuccess","tokenResponse","apiClient","tiersData","tiersError","supabase","formattedTiers","tier","err","handleTierSelection","selectedTier","response","formatPrice","priceInCents","jsxs","jsx","Card","AlertCircle","Button","timeUntilExpiry","hoursUntilExpiry","Clock","index","CheckCircle","t","CreditCard"],"mappings":"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"}