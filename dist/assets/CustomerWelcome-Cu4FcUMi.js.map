{"version":3,"file":"CustomerWelcome-Cu4FcUMi.js","sources":["../../src/pages/customer/CustomerWelcome.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useSearchParams, useNavigate } from 'react-router-dom';\r\nimport Button from '../../components/Button';\r\nimport Card from '../../components/Card';\r\nimport { CheckCircle, AlertCircle, Wine, Calendar, Heart, ArrowRight } from 'lucide-react';\r\n\r\ninterface CustomerWelcomeData {\r\n  customer: {\r\n    id: string;\r\n    name: string;\r\n    email: string;\r\n    tier_name: string;\r\n    subscription_status: string;\r\n  };\r\n  business: {\r\n    id: string;\r\n    name: string;\r\n    website?: string;\r\n  };\r\n  subscription: {\r\n    id: string;\r\n    status: string;\r\n    current_period_end: string;\r\n    amount: number;\r\n  };\r\n}\r\n\r\nconst CustomerWelcome: React.FC = () => {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  \r\n  const [welcomeData, setWelcomeData] = useState<CustomerWelcomeData | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const sessionId = searchParams.get('session_id');\r\n  const token = searchParams.get('token');\r\n\r\n  useEffect(() => {\r\n    const verifyPaymentAndCreateCustomer = async () => {\r\n      if (!sessionId || !token) {\r\n        setError('Missing session or token information');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await fetch('/api/verify-customer-payment', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify({ sessionId, token }),\r\n        });\r\n\r\n        if (!response.ok) {\r\n          throw new Error('Failed to verify payment');\r\n        }\r\n\r\n        const data = await response.json();\r\n        setWelcomeData(data);\r\n      } catch (err) {\r\n        setError(err instanceof Error ? err.message : 'Failed to process your membership');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    verifyPaymentAndCreateCustomer();\r\n  }, [sessionId, token]);\r\n\r\n  // Loading state\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-[#fdfaf7] px-6 py-10 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#800020] mx-auto mb-4\"></div>\r\n          <p className=\"text-lg text-gray-600\">Activating your membership...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Error state\r\n  if (error || !welcomeData) {\r\n    return (\r\n      <div className=\"min-h-screen bg-[#fdfaf7] px-6 py-10 flex items-center justify-center\">\r\n        <Card className=\"max-w-md mx-auto p-8 text-center\">\r\n          <AlertCircle className=\"h-16 w-16 text-red-500 mx-auto mb-4\" />\r\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Payment Processing Error</h1>\r\n          <p className=\"text-gray-600 mb-6\">\r\n            {error || 'There was an issue processing your membership. Please contact support.'}\r\n          </p>\r\n          <Button onClick={() => navigate('/')} variant=\"secondary\" className=\"w-full\">\r\n            Return Home\r\n          </Button>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const currentPeriodEnd = new Date(welcomeData.subscription.current_period_end);\r\n  const nextBillingDate = currentPeriodEnd.toLocaleDateString('en-US', {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric'\r\n  });\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[#fdfaf7] px-6 py-10\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        {/* Success Header */}\r\n        <div className=\"text-center mb-12\">\r\n          <CheckCircle className=\"h-24 w-24 text-green-500 mx-auto mb-6\" />\r\n          <h1 className=\"text-4xl font-bold text-gray-900 mb-4\">\r\n            🎉 Welcome to {welcomeData.business.name}'s Wine Club!\r\n          </h1>\r\n          <p className=\"text-xl text-gray-600 mb-2\">\r\n            Your membership has been successfully activated\r\n          </p>\r\n          <p className=\"text-lg text-gray-500\">\r\n            Get ready for an amazing wine journey, {welcomeData.customer.name}!\r\n          </p>\r\n        </div>\r\n\r\n        {/* Membership Details */}\r\n        <Card className=\"p-8 mb-8\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-6 text-center\">\r\n            Your Membership Details\r\n          </h2>\r\n          \r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div className=\"text-center p-6 bg-[#800020]/5 rounded-lg border border-[#800020]/20\">\r\n              <Wine className=\"h-12 w-12 text-[#800020] mx-auto mb-4\" />\r\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\r\n                {welcomeData.customer.tier_name} Member\r\n              </h3>\r\n              <p className=\"text-sm text-gray-600\">\r\n                ${(welcomeData.subscription.amount / 100).toFixed(2)}/month\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"text-center p-6 bg-green-50 rounded-lg border border-green-200\">\r\n              <CheckCircle className=\"h-12 w-12 text-green-600 mx-auto mb-4\" />\r\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\r\n                Status: Active\r\n              </h3>\r\n              <p className=\"text-sm text-gray-600\">\r\n                Next billing: {nextBillingDate}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </Card>\r\n\r\n        {/* What's Next */}\r\n        <Card className=\"p-8 mb-8\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-6 text-center\">\r\n            What Happens Next?\r\n          </h2>\r\n          \r\n          <div className=\"space-y-6\">\r\n            <div className=\"flex items-start\">\r\n              <div className=\"w-8 h-8 bg-[#800020] text-white rounded-full flex items-center justify-center text-sm font-bold mr-4 mt-1\">\r\n                1\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-gray-900 mb-1\">Profile Curation</p>\r\n                <p className=\"text-gray-600\">\r\n                  Our wine experts will review your preferences and curate personalized selections\r\n                </p>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"flex items-start\">\r\n              <div className=\"w-8 h-8 bg-[#800020] text-white rounded-full flex items-center justify-center text-sm font-bold mr-4 mt-1\">\r\n                2\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-gray-900 mb-1\">First Shipment</p>\r\n                <p className=\"text-gray-600\">\r\n                  Your first curated wine selection will be shipped within 3-5 business days\r\n                </p>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"flex items-start\">\r\n              <div className=\"w-8 h-8 bg-[#800020] text-white rounded-full flex items-center justify-center text-sm font-bold mr-4 mt-1\">\r\n                3\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-gray-900 mb-1\">Member Dashboard</p>\r\n                <p className=\"text-gray-600\">\r\n                  Access your personal dashboard to track shipments, rate wines, and update preferences\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </Card>\r\n\r\n        {/* Member Benefits */}\r\n        <Card className=\"p-8 mb-8 bg-gradient-to-br from-[#800020]/5 to-[#800020]/10\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-6 text-center\">\r\n            Your Member Benefits\r\n          </h2>\r\n          \r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n            <div className=\"text-center\">\r\n              <Wine className=\"h-8 w-8 text-[#800020] mx-auto mb-3\" />\r\n              <h3 className=\"font-semibold text-gray-900 mb-2\">Curated Selections</h3>\r\n              <p className=\"text-sm text-gray-600\">\r\n                Hand-picked wines based on your taste preferences\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"text-center\">\r\n              <Calendar className=\"h-8 w-8 text-[#800020] mx-auto mb-3\" />\r\n              <h3 className=\"font-semibold text-gray-900 mb-2\">Flexible Delivery</h3>\r\n              <p className=\"text-sm text-gray-600\">\r\n                Monthly deliveries with easy skip and pause options\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"text-center\">\r\n              <Heart className=\"h-8 w-8 text-[#800020] mx-auto mb-3\" />\r\n              <h3 className=\"font-semibold text-gray-900 mb-2\">Expert Support</h3>\r\n              <p className=\"text-sm text-gray-600\">\r\n                Access to wine experts and tasting notes\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </Card>\r\n\r\n        {/* Call to Action */}\r\n        <div className=\"text-center space-y-4\">\r\n          <Button\r\n            onClick={() => navigate('/customer/dashboard')}\r\n            className=\"px-8 py-3\"\r\n          >\r\n            Access Your Dashboard\r\n            <ArrowRight className=\"w-5 h-5 ml-2\" />\r\n          </Button>\r\n          \r\n          <p className=\"text-sm text-gray-500\">\r\n            A confirmation email has been sent to {welcomeData.customer.email}\r\n          </p>\r\n        </div>\r\n\r\n        {/* Contact Support */}\r\n        <div className=\"text-center mt-12 p-6 bg-gray-50 rounded-lg border border-gray-200\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\r\n            Questions About Your Membership?\r\n          </h3>\r\n          <p className=\"text-gray-600 mb-4\">\r\n            Our customer service team is here to help\r\n          </p>\r\n          <div className=\"space-y-2 text-sm\">\r\n            <p>\r\n              📧 Email: <a href=\"mailto:support@clubcuvee.com\" className=\"text-[#800020] hover:underline\">support@clubcuvee.com</a>\r\n            </p>\r\n            {welcomeData.business.website && (\r\n              <p>\r\n                🌐 Business: <a href={welcomeData.business.website} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-[#800020] hover:underline\">\r\n                  {welcomeData.business.name}\r\n                </a>\r\n              </p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CustomerWelcome;"],"names":["CustomerWelcome","searchParams","useSearchParams","navigate","useNavigate","welcomeData","setWelcomeData","useState","loading","setLoading","error","setError","sessionId","token","useEffect","response","data","err","jsxs","jsx","Card","AlertCircle","Button","nextBillingDate","CheckCircle","Wine","Calendar","Heart","ArrowRight"],"mappings":"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"}