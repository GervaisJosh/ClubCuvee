{"version":3,"file":"token-DrIgv3wV.js","sources":["../../src/types/onboarding.ts","../../src/lib/errors.ts","../../src/pages/onboarding/token.tsx"],"sourcesContent":["export interface RestaurantInvite {\r\n  id: string;\r\n  token: string;\r\n  email: string;\r\n  restaurantName: string;\r\n  invitedBy: string;\r\n  website?: string;\r\n  tier: MembershipTier;\r\n  status: 'pending' | 'in_progress' | 'accepted' | 'expired';\r\n  created_at: string;\r\n  expires_at: string;\r\n  accepted_at?: string;\r\n}\r\n\r\nexport interface OnboardingFormData {\r\n  restaurantName: string;\r\n  email: string;\r\n  membershipTier: MembershipTier;\r\n}\r\n\r\nexport type MembershipTier = 'basic' | 'premium' | 'enterprise';\r\n\r\nexport interface MembershipTierOption {\r\n  id: MembershipTier;\r\n  name: string;\r\n  description: string;\r\n  price: number;\r\n  features: string[];\r\n}\r\n\r\nexport const MEMBERSHIP_TIERS: MembershipTierOption[] = [\r\n  {\r\n    id: 'basic',\r\n    name: 'Basic',\r\n    description: 'Perfect for small restaurants',\r\n    price: 99,\r\n    features: [\r\n      'Up to 100 wine selections',\r\n      'Basic analytics',\r\n      'Email support',\r\n      'Monthly reports'\r\n    ]\r\n  },\r\n  {\r\n    id: 'premium',\r\n    name: 'Premium',\r\n    description: 'For growing restaurants',\r\n    price: 199,\r\n    features: [\r\n      'Up to 500 wine selections',\r\n      'Advanced analytics',\r\n      'Priority support',\r\n      'Weekly reports',\r\n      'Custom branding',\r\n      'API access'\r\n    ]\r\n  },\r\n  {\r\n    id: 'enterprise',\r\n    name: 'Enterprise',\r\n    description: 'For large establishments',\r\n    price: 499,\r\n    features: [\r\n      'Unlimited wine selections',\r\n      'Enterprise analytics',\r\n      '24/7 support',\r\n      'Real-time reports',\r\n      'Custom branding',\r\n      'API access',\r\n      'Dedicated account manager',\r\n      'Custom integrations'\r\n    ]\r\n  }\r\n]; ","export class APIError extends Error {\r\n  constructor(\r\n    public statusCode: number,\r\n    message: string,\r\n    public code?: string\r\n  ) {\r\n    super(message);\r\n    this.name = 'APIError';\r\n  }\r\n} ","import { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { OnboardingFormData, MEMBERSHIP_TIERS, MembershipTierOption } from '../../types/onboarding';\r\nimport { APIError } from '../../lib/errors';\r\n\r\nexport default function OnboardingPage() {\r\n  const { token } = useParams<{ token: string }>();\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [formData, setFormData] = useState<OnboardingFormData>({\r\n    restaurantName: '',\r\n    email: '',\r\n    membershipTier: 'basic',\r\n  });\r\n\r\n  useEffect(() => {\r\n    const validateInvite = async () => {\r\n      if (!token) {\r\n        setError('Invalid invite token');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await fetch(`/api/restaurant-invite?token=${token}`);\r\n        if (!response.ok) {\r\n          const data = await response.json();\r\n          throw new APIError(response.status, data.error.message, data.error.code);\r\n        }\r\n        const data = await response.json();\r\n        setFormData(prev => ({\r\n          ...prev,\r\n          restaurantName: data.restaurantName,\r\n          email: data.email,\r\n        }));\r\n      } catch (err) {\r\n        setError(err instanceof Error ? err.message : 'Failed to validate invite');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    validateInvite();\r\n  }, [token]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    if (!token) {\r\n      setError('Invalid invite token');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await fetch('/api/create-checkout-session', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          token,\r\n          membershipTier: formData.membershipTier,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const data = await response.json();\r\n        throw new APIError(response.status, data.error.message, data.error.code);\r\n      }\r\n\r\n      const { url } = await response.json();\r\n      window.location.href = url;\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to create checkout session');\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"max-w-md w-full p-6 bg-white rounded-lg shadow-lg\">\r\n          <h1 className=\"text-2xl font-bold text-red-600 mb-4\">Error</h1>\r\n          <p className=\"text-gray-600\">{error}</p>\r\n          <button\r\n            onClick={() => navigate('/')}\r\n            className=\"mt-4 px-4 py-2 bg-primary text-white rounded hover:bg-primary-dark\"\r\n          >\r\n            Return Home\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-3xl mx-auto\">\r\n        <div className=\"text-center mb-8\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">Welcome to Club Cuvee</h1>\r\n          <p className=\"mt-2 text-gray-600\">\r\n            Complete your restaurant's onboarding to get started\r\n          </p>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"space-y-8\">\r\n          <div className=\"bg-white shadow rounded-lg p-6\">\r\n            <div className=\"space-y-6\">\r\n              <div>\r\n                <label htmlFor=\"restaurantName\" className=\"block text-sm font-medium text-gray-700\">\r\n                  Restaurant Name\r\n                </label>\r\n                <input\r\n                  id=\"restaurantName\"\r\n                  type=\"text\"\r\n                  value={formData.restaurantName}\r\n                  onChange={e => setFormData(prev => ({ ...prev, restaurantName: e.target.value }))}\r\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary\"\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\r\n                  Email\r\n                </label>\r\n                <input\r\n                  id=\"email\"\r\n                  type=\"email\"\r\n                  value={formData.email}\r\n                  onChange={e => setFormData(prev => ({ ...prev, email: e.target.value }))}\r\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary\"\r\n                  required\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white shadow rounded-lg p-6\">\r\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Choose Your Plan</h2>\r\n            <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-3\">\r\n              {MEMBERSHIP_TIERS.map((tier) => (\r\n                <div\r\n                  key={tier.id}\r\n                  className={`relative rounded-lg border p-6 cursor-pointer ${\r\n                    formData.membershipTier === tier.id\r\n                      ? 'border-primary ring-2 ring-primary'\r\n                      : 'border-gray-300'\r\n                  }`}\r\n                  onClick={() => setFormData(prev => ({ ...prev, membershipTier: tier.id }))}\r\n                >\r\n                  <h3 className=\"text-lg font-medium text-gray-900\">{tier.name}</h3>\r\n                  <p className=\"mt-1 text-sm text-gray-500\">{tier.description}</p>\r\n                  <p className=\"mt-4\">\r\n                    <span className=\"text-4xl font-bold text-gray-900\">${tier.price}</span>\r\n                    <span className=\"text-base font-medium text-gray-500\">/month</span>\r\n                  </p>\r\n                  <ul className=\"mt-6 space-y-4\">\r\n                    {tier.features.map((feature) => (\r\n                      <li key={feature} className=\"flex items-start\">\r\n                        <svg\r\n                          className=\"h-5 w-5 text-green-500\"\r\n                          fill=\"none\"\r\n                          stroke=\"currentColor\"\r\n                          viewBox=\"0 0 24 24\"\r\n                        >\r\n                          <path\r\n                            strokeLinecap=\"round\"\r\n                            strokeLinejoin=\"round\"\r\n                            strokeWidth={2}\r\n                            d=\"M5 13l4 4L19 7\"\r\n                          />\r\n                        </svg>\r\n                        <span className=\"ml-3 text-sm text-gray-700\">{feature}</span>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex justify-end\">\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              className=\"px-6 py-3 bg-primary text-white rounded-md hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50\"\r\n            >\r\n              {loading ? 'Processing...' : 'Continue to Payment'}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"names":["MEMBERSHIP_TIERS","APIError","statusCode","message","code","OnboardingPage","token","useParams","navigate","useNavigate","loading","setLoading","useState","error","setError","formData","setFormData","useEffect","response","data","prev","err","handleSubmit","e","url","jsx","jsxs","tier","feature"],"mappings":"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"}